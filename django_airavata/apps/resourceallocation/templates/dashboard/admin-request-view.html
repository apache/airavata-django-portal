{% extends 'dashboard/base.html' %}
{% block title %} Allocation Manager - Admin{% endblock %}
{% block body %}


        <!-- All Requests-->
        <div class="container">
            <div class="form-group">
            <h3>{{ userSubmittedDetails.title|capfirst }}</h3>
              <form action="" method="post">
                            {% csrf_token %}
                <select onchange="this.form.submit()" class="selectpicker" data-style="btn-primary" data-live-search="true" name="selectedReviewer">
                    <option>Select the assigned reviewer</option>
                    {% for reviewer in assignedReviewersList %}
                        <option value="{{reviewer.username}}" {% if reviewer.username == selectedReviewer %}selected="selected"{% endif %}>
                           {{reviewer.fullName|capfirst}}
                        </option>
                    {% endfor %}
                   </select>
              </form>
            </div>

            {% if reviewerReview and reviewerReview.projectId %}
            <table class="table table-hover table-bordered table-striped table-responsive">
                <thead class="thead-inverse">
                  <tr style="background-color: #337ab7;color:white">
                    <th>Request Fields</th>
                    <th>User Submitted</th>
                    <th>Reviewer Submitted</th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <td>Allocation type</td>
                        <td>{{ userSubmittedDetails.typeOfAllocation|capfirst }}</td>
                        <td>{{ reviewerReview.typeOfAllocation|capfirst }}</td>
                    </tr>
                    <tr>
                        <td>Applications to be used</td>
                        <td>{{ userSubmittedDetails.applicationsToBeUsed|capfirst }}</td>
                        <td>{{ reviewerReview.applicationsToBeUsed|capfirst }}</td>
                       <!-- <td>
                            <div class="dropdown">
                              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Selected Applications
                              <span class="caret"></span></button>
                              <ul class="dropdown-menu">
                                <li>HTML</li>
                                <li>CSS</li>
                                <li>JavaScript</li>
                              </ul>
                            </div>
                        </td>
                        <td>
                            <div class="dropdown">
                              <button class="btn btn-primary dropdown-toggle" type="button" data-toggle="dropdown">Selected Applications
                              <span class="caret"></span></button>
                              <ul class="dropdown-menu">
                                <li>HTML</li>
                                <li>CSS</li>
                                <li>JavaScript</li>
                              </ul>
                            </div>
                        </td>-->
                    </tr>
                    <tr>
                        <td>Disk Usage Range Per Job</td>
                        <td>{{ userSubmittedDetails.diskUsageRangePerJob }}</td>
                        <td>{{ reviewerReview.diskUsageRangePerJob }}</td>
                    </tr>
                    <tr>
                        <td>Keywords</td>
                        <td>{{ userSubmittedDetails.keywords|capfirst }}</td>
                        <td>{{ reviewerReview.keywords|capfirst }}</td>
                    </tr>
                    <tr>
                        <td>Max Memory Per CPU</td>
                        <td>{{ userSubmittedDetails.maxMemoryPerCpu }}</td>
                        <td>{{ reviewerReview.maxMemoryPerCpu }}</td>
                    </tr>
                    <tr>
                        <td>Num CPUs Per Job</td>
                        <td>{{ userSubmittedDetails.numberOfCpuPerJob }}</td>
                        <td>{{ reviewerReview.numberOfCpuPerJob }}</td>
                    </tr>
                    <tr>
                        <td>Service Units</td>
                        <td>{{ userSubmittedDetails.serviceUnits }}</td>
                        <td>{{ reviewerReview.serviceUnits }}</td>
                    </tr>
                    <tr>
                        <td>Typical Service Units/Job</td>
                        <td>{{ userSubmittedDetails.typicalSuPerJob }}</td>
                        <td>{{ reviewerReview.typicalSuPerJob }}</td>
                    </tr>
                </tbody>
             </table>


            <button type="button" class="btn btn-success" data-toggle="modal" data-target="#approve">Approve</button>
            <!-- Modal -->
                  <div class="modal fade" id="approve" role="dialog">
                    <div class="modal-dialog modal-sm">
                      <div class="modal-content">
                           <form action="" method="post">
                               {% csrf_token %}
                        <div class="modal-header">

                          <button type="button" class="close" data-dismiss="modal">&times;</button>
                          <h4 class="modal-title">Approve Request</h4>

                        </div>
                        <div class="modal-body">

                          <div class="form-group">
                                Start Date :
                                <input required type="date" name="start" style="border: none;" >
                          </div>
                          <div class="form-group">
                                End Date :
                                <input required type="date" name="end" style="border: none;">
                          </div>
                          <div>
                                Allocation Units:
                                <input required type="text" name="allocation-units">
                          </div>

                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-success" >Approve</button>
                          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                           </form>
                      </div>
                    </div>
                  </div>
            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#reject">Reject</button>
            <!-- Modal -->
                  <div class="modal fade" id="reject" role="dialog">
                    <div class="modal-dialog modal-sm">
                      <div class="modal-content">
                           <form action="" method="post">
                                {% csrf_token %}
                        <div class="modal-header">
                          <button type="button" class="close" data-dismiss="modal">&times;</button>
                          <h4 class="modal-title">Reject Request</h4>
                        </div>
                        <div class="modal-body">

                          <div class="form-group">
                                Reason :
                                <input required type="text" name="reject-reason" >
                          </div>
                        </div>
                        <div class="modal-footer">
                            <button type="submit" class="btn btn-danger" >Reject</button>
                          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                           </form>
                      </div>
                    </div>
                  </div>
        </div>
            {% elif selectedReviewer == "" %}
                <h3 style="margin-left: 7%"><br/>Select assigned reviewer</h3><div></div>
            {%  else %}
                <h3 style="margin-left: 7%"><br/>Sorry, no review for this request has been submitted yet!</h3>
            {% endif %}
 {%  endblock %}